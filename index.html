<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto 2-Machine Learning</title>
    <script type="text/javascript" src="tytus.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
    <h2>Proyecto 2- Machine Learning - Inteligencia Artificial 1</h2>
    <p id="log"></p>

    <label for="modelSelect">Seleccione el modelo:</label>
    <select id="modelSelect">
        <option value="seleccionar">Seleccionar</option>
        <option value="regresionLineal">Regresión Lineal</option>
        <option value="regresionLogistica">Regresión Logistica</option>
        <option value="arbolDecision">Arbol de Decision</option>
        <!-- Puedes agregar más opciones aquí en el futuro -->
    </select>
    
    <input type="file" id="fileInput" accept=".csv" />
    <button onclick="executeModel()">Ejecutar Modelo</button>

    <div id="chart_div" style="width: 900px; height: 500px;"></div>

    <script type="text/javascript">
        function executeModel() {
            const model = document.getElementById('modelSelect').value;

            if (model === 'regresionLineal') {
                loadCSV(); // Solo ejecutará loadCSV si se selecciona "Regresión Lineal"
            } else {
                alert('Por favor, selecciona un modelo válido.');
            }
        }

        function loadCSV() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) {
                alert('Por favor, selecciona un archivo CSV.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(event) {
                const csvData = event.target.result;
                processCSV(csvData);
            };
            reader.readAsText(file);
        }

        function processCSV(data) {
            const lines = data.split('\n');
            const xTrain = [];
            const yTrain = [];

            // Asumiendo que el CSV tiene encabezado: X,Y
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].split(',');
                if (line.length === 2) { // Asegúrate de que hay 2 columnas
                    xTrain.push(parseFloat(line[0]));
                    yTrain.push(parseFloat(line[1]));
                }
            }

            // Crear y ajustar el modelo de regresión lineal
            var linear = new LinearRegression();
            linear.fit(xTrain, yTrain);
            const yPredict = linear.predict(xTrain);

            document.getElementById("log").innerHTML = '<br>X Train: ' + xTrain + '<br>Y Train: ' + yTrain + '<br>Y Predict: ' + yPredict;
            const a = joinArrays('x', xTrain, 'yTrain', yTrain, 'yPredict', yPredict);

            google.charts.load('current', {'packages': ['corechart']});
            google.charts.setOnLoadCallback(() => drawChart(a));
        }

        function drawChart(dataArray) {
            var data = google.visualization.arrayToDataTable(dataArray);
            var options = {
                seriesType: 'scatter',
                series: {1: {type: 'line'}}
            };
            var chart = new google.visualization.ComboChart(document.getElementById('chart_div'));
            chart.draw(data, options);
        }
    </script>
</body>
</html>

